{% extends "base.html" %}{% load static %}
{% block title%} CP {% endblock %}

{% block stylesheet %}
    <link rel="icon" href="/media/fav.png" />
    <link rel="stylesheet" href="/static/css/styles.css"> 
{% endblock %}

{% block main %}
      

   <!-- <p style="color:white">Hello</p> -->
    <div id="countdown" data-time-upto="2020/6/17 12:00:00">
    </div>


{% endblock %}
    
{% block javascript %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
       $('#sub_id').click(function(e){
           $.ajax({
               type:'POST',
               url:"/cp/",
               data:$('#prob-form').serialize(),
               success:function(data){
                   console.log(data['prob']);
                   $('#p').append("<p>" + data['prob'][0] + "</p>");
                   $('#p').append("<p>" + data['prob'][1] + "</p>");
                   document.getElementById("prob-form").reset();
               }
           });
       });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script>
        /* --------------------------
         * GLOBAL VARS
         * -------------------------- */
        // The date you want to count down to
        console.log($('#countdown').data('time-upto'));
        var targetDate = new Date($('#countdown').data('time-upto'));
        // Other date related variables
        var days;
        var hrs;
        var min;
        var sec;
        /* --------------------------
         * ON DOCUMENT LOAD
         * -------------------------- */
        $(function() {
            // Calculate time until launch date
            timeToLaunch();
            // Transition the current countdown from 0 
            numberTransition('#days .number', days, 1000, 'easeOutQuad');
            numberTransition('#hours .number', hrs, 1000, 'easeOutQuad');
            numberTransition('#minutes .number', min, 1000, 'easeOutQuad');
            numberTransition('#seconds .number', sec, 1000, 'easeOutQuad');
            // Begin Countdown
            setTimeout(countDownTimer, 1001);
        });
        /* --------------------------
         * FIGURE OUT THE AMOUNT OF 
           TIME LEFT BEFORE LAUNCH
         * -------------------------- */
        function timeToLaunch() {
            // Get the current date
            var currentDate = new Date();
            // Find the difference between dates
            var diff = (currentDate - targetDate) / 1000;
            var diff = Math.abs(Math.floor(diff));
            // Check number of days until target
            days = Math.floor(diff / (24 * 60 * 60));
            sec = diff - days * 24 * 60 * 60;
            // Check number of hours until target
            hrs = Math.floor(sec / (60 * 60));
            sec = sec - hrs * 60 * 60;
            // Check number of minutes until target
            min = Math.floor(sec / (60));
            sec = sec - min * 60;
        }
        /* --------------------------
         * DISPLAY THE CURRENT 
           COUNT TO LAUNCH
         * -------------------------- */
        function countDownTimer() {
            // Figure out the time to launch
            timeToLaunch();
            // Write to countdown component
            $("#days .number").text(days);
            $("#hours .number").text(hrs);
            $("#minutes .number").text(min);
            $("#seconds .number").text(sec);
            $("#countdown").text(days + " : "+hrs+" : "+ min + " : "+sec);
            // Repeat the check every second
            setTimeout(countDownTimer, 1000);
        }
        /* --------------------------
         * TRANSITION NUMBERS FROM 0
           TO CURRENT TIME UNTIL LAUNCH
         * -------------------------- */
        function numberTransition(id, endPoint, transitionDuration, transitionEase) {
            // Transition numbers from 0 to the final number
            $({
                numberCount: $(id).text()
            }).animate({
                numberCount: endPoint
            }, {
                duration: transitionDuration,
                easing: transitionEase,
                step: function() {
                    $(id).text(Math.floor(this.numberCount));
                },
                complete: function() {
                    $(id).text(this.numberCount);
                }
            });
        };
    </script>
{% endblock %}